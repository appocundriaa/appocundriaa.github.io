<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Marco Marino</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <header class="header">
    <div class="header-grid">
      <div></div>

      <div class="header-content">

        <!-- TESTO: NON MODIFICARE -->
        <p id="bioSource" class="sr-only">
È un Sironi! Tra i più famosi. Pubblicato su tutti i cataloghi. È del periodo pessimista! Il più raro. Questo se t'o attacchi in ufficio c'hai uno scatto da così a così! Te lo metti in casa, fai un figurone! Io ce l'ho avuto in salotto per vent'anni, tu non sai quanto m'ha aiutato a me, le serate che m'ha risolto... perché è anche un argomento di conversazione, sai? C'è pure chi dice: se c'ha 'e zinne viola, de che colore c'avrà er culo?
        </p>

        <!-- T-SHIRT (SVG clip robusto) -->
        <div class="tshirt-wrap" aria-label="Testo dentro una maglietta">
          <svg id="tshirtSvg" class="tshirt-svg" viewBox="0 0 512 512" role="img" aria-label="T-shirt text">
            <defs>
              <!-- silhouette: più “icona-like” (spalle inclinate + maniche a gradino + collo scavato) -->
              <clipPath id="tshirtClip" clipPathUnits="userSpaceOnUse">
                <path d="
                  M140 120
                  L90 155
                  L120 230
                  L180 205
                  L180 440
                  L332 440
                  L332 205
                  L392 230
                  L422 155
                  L372 120
                  C345 150 310 165 256 165
                  C202 165 167 150 140 120
                  Z

                  M205 120
                  C220 150 236 165 256 165
                  C276 165 292 150 307 120
                  C292 98 276 88 256 88
                  C236 88 220 98 205 120
                  Z
                "/>
              </clipPath>

              <!-- bordo (opzionale, invisibile di default via CSS) -->
              <path id="tshirtOutline" d="
                M140 120
                L90 155
                L120 230
                L180 205
                L180 440
                L332 440
                L332 205
                L392 230
                L422 155
                L372 120
                C345 150 310 165 256 165
                C202 165 167 150 140 120
                Z

                M205 120
                C220 150 236 165 256 165
                C276 165 292 150 307 120
                C292 98 276 88 256 88
                C236 88 220 98 205 120
                Z
              "/>
            </defs>

            <!-- contenuto clippato -->
            <foreignObject x="0" y="0" width="512" height="512" clip-path="url(#tshirtClip)">
              <div xmlns="http://www.w3.org/1999/xhtml" class="tshirt-fo">
                <div id="tshirtText" class="tshirt-text"></div>
              </div>
            </foreignObject>

            <!-- outline debug (se vuoi vederlo, abilita in CSS) -->
            <use href="#tshirtOutline" class="tshirt-debug-outline"></use>
          </svg>
        </div>

        <!-- CONTATTI -->
        <div class="contact-wrapper">
          <p class="role">Editor, writer, historian &amp;c.</p>
          <div class="contact-link-wrapper">
            <a class="link" href="mailto:mmarino1@iuav.it">mmarino1@iuav.it</a>
            <span class="sep">|</span>
            <a class="link" href="https://www.instagram.com/appocundriaa/" target="_blank" rel="noreferrer">
              @appocundriaa ↗
            </a>
            <span class="sep">|</span>
            <a class="link" href="#" target="_blank" rel="noreferrer">substack.com ↗</a>
          </div>
        </div>

        <!-- FILTRI -->
        <section class="filters" aria-label="Filtri">
          <div class="filter-stack" id="filterStack">

            <!-- scarabocchio: doppio path per effetto “hand-drawn” -->
            <svg class="filter-connector" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
              <path id="scribbleA" d="" fill="none"></path>
              <path id="scribbleB" d="" fill="none"></path>
            </svg>

            <div class="filter-group" id="categoryGroup">
              <button class="pill" data-filter="Essay" type="button">Essay</button>
              <button class="pill" data-filter="Speaking" type="button">Speaking</button>
              <button class="pill" data-filter="Editing" type="button">Editing</button>
              <button class="pill is-active" data-filter="Journalism" type="button">Journalism</button>
            </div>

            <div class="filter-group" id="tagGroup">
              <button class="pill is-active" data-filter="Fashion" type="button">Fashion</button>
              <button class="pill" data-filter="Art" type="button">Art</button>
              <button class="pill" data-filter="Culture" type="button">Culture</button>
              <button class="pill" data-filter="Design" type="button">Design</button>
              <button class="pill" data-filter="History" type="button">History</button>
            </div>
          </div>
        </section>

      </div>

      <div></div>
    </div>
  </header>

  <main class="page-content">
    <section class="work-grid" aria-label="Lavori">
      <article class="work-row" data-category="Journalism" data-tags="Fashion,Design">
        <div class="work-year">2025</div>
        <div class="work-title">
          <a class="work-link" href="#" target="_blank" rel="noreferrer">
            Behind the Campaign @ Miu Miu with Lengua ↗
          </a>
        </div>
        <div class="work-spacer"></div>
      </article>

      <article class="work-row" data-category="Journalism" data-tags="Fashion,Design">
        <div class="work-year">2025</div>
        <div class="work-title">
          <a class="work-link" href="#" target="_blank" rel="noreferrer">
            An Interview with Evan Kinori @ 1 Granary ↗
          </a>
        </div>
        <div class="work-spacer"></div>
      </article>

      <article class="work-row" data-category="Journalism" data-tags="Fashion,Culture">
        <div class="work-year">2025</div>
        <div class="work-title">
          <a class="work-link" href="#" target="_blank" rel="noreferrer">
            Trend Forecasters on Predicting the Future @ 1 Granary ↗
          </a>
        </div>
        <div class="work-spacer"></div>
      </article>
    </section>

    <footer class="footer">
      <p>© 2026 – Marco Marino</p>
    </footer>
  </main>

  <script>
    // -------------------------
    // 1) monta testo dentro svg
    // -------------------------
    function mountTshirtText() {
      const src = document.getElementById('bioSource');
      const target = document.getElementById('tshirtText');
      if (!src || !target) return;
      target.textContent = src.textContent.trim().replace(/\s+/g, ' ');
    }

    // -------------------------
    // 2) fit font-size nel box della maglietta
    //    (lavora sul contenitore HTML dentro foreignObject)
    // -------------------------
    function fitTshirtText() {
      const fo = document.querySelector('.tshirt-fo');
      const t = document.getElementById('tshirtText');
      if (!fo || !t) return;

      // reset
      t.style.fontSize = '14px';

      const maxH = fo.clientHeight;
      const maxW = fo.clientWidth;

      // riduci finché entra
      let size = 14;
      for (let i = 0; i < 40; i++) {
        const tooTall = t.scrollHeight > maxH;
        const tooWide = t.scrollWidth > maxW;
        if (!tooTall && !tooWide) break;
        size -= 0.5;
        t.style.fontSize = size + 'px';
        if (size <= 9) break;
      }
    }

    // -------------------------
    // 3) filtri + lista
    // -------------------------
    function setupFilters() {
      const state = { category: 'Journalism', tag: 'Fashion' };
      const categoryGroup = document.getElementById('categoryGroup');
      const tagGroup = document.getElementById('tagGroup');

      const normTags = (raw) => (raw || '').split(',').map(s => s.trim()).filter(Boolean);

      const setActive = (groupEl, value) => {
        groupEl.querySelectorAll('.pill').forEach(btn => {
          btn.classList.toggle('is-active', btn.dataset.filter === value);
        });
      };

      const updateList = () => {
        document.querySelectorAll('.work-row').forEach((row) => {
          const c = row.getAttribute('data-category') || '';
          const tags = normTags(row.getAttribute('data-tags'));
          row.style.display = (c === state.category && tags.includes(state.tag)) ? '' : 'none';
        });
      };

      const bind = (groupEl, key) => {
        groupEl.addEventListener('click', (e) => {
          const btn = e.target.closest('button[data-filter]');
          if (!btn) return;
          state[key] = btn.dataset.filter;
          setActive(groupEl, state[key]);
          updateList();
          drawScribble(state.category + '|' + state.tag);
        });
      };

      bind(categoryGroup, 'category');
      bind(tagGroup, 'tag');
      setActive(categoryGroup, state.category);
      setActive(tagGroup, state.tag);
      updateList();

      // prima draw
      drawScribble(state.category + '|' + state.tag);
    }

    // -------------------------
    // 4) scarabocchio hand-drawn (stabile, ma “imperfetto”)
    //    - genera punti su una curva e aggiunge jitter
    // -------------------------
    function seededRand(seedStr) {
      // xorshift32 semplice
      let h = 2166136261;
      for (let i = 0; i < seedStr.length; i++) h = (h ^ seedStr.charCodeAt(i)) * 16777619;
      let x = h >>> 0;
      return () => {
        x ^= x << 13; x >>>= 0;
        x ^= x >> 17; x >>>= 0;
        x ^= x << 5;  x >>>= 0;
        return (x >>> 0) / 4294967296;
      };
    }

    function drawScribble(seedKey) {
      const stackEl = document.getElementById('filterStack');
      const categoryGroup = document.getElementById('categoryGroup');
      const tagGroup = document.getElementById('tagGroup');
      const aPath = document.getElementById('scribbleA');
      const bPath = document.getElementById('scribbleB');
      if (!stackEl || !categoryGroup || !tagGroup || !aPath || !bPath) return;

      const a = categoryGroup.querySelector('.pill.is-active');
      const b = tagGroup.querySelector('.pill.is-active');
      if (!a || !b) { aPath.setAttribute('d',''); bPath.setAttribute('d',''); return; }

      const fr = stackEl.getBoundingClientRect();
      const ra = a.getBoundingClientRect();
      const rb = b.getBoundingClientRect();

      const x1 = ((ra.left + ra.width/2) - fr.left) / fr.width * 100;
      const y1 = ((ra.top + ra.height/2) - fr.top) / fr.height * 100;
      const x2 = ((rb.left + rb.width/2) - fr.left) / fr.width * 100;
      const y2 = ((rb.top + rb.height/2) - fr.top) / fr.height * 100;

      const r = seededRand(seedKey);

      // curva base (S morbida)
      const cx1 = x1 + (x2 - x1) * 0.25;
      const cy1 = y1 + (y2 - y1) * 0.10 - 10;
      const cx2 = x1 + (x2 - x1) * 0.75;
      const cy2 = y1 + (y2 - y1) * 0.90 + 10;

      // campiona la bezier e jittera punti
      function bezier(t){
        const mt = 1 - t;
        const x = mt*mt*mt*x1 + 3*mt*mt*t*cx1 + 3*mt*t*t*cx2 + t*t*t*x2;
        const y = mt*mt*mt*y1 + 3*mt*mt*t*cy1 + 3*mt*t*t*cy2 + t*t*t*y2;
        return {x,y};
      }

      function makeScribble(offset = 0) {
        const pts = [];
        const steps = 18;
        for (let i = 0; i <= steps; i++) {
          const t = i / steps;
          const p = bezier(t);

          // jitter: più forte a metà, più leggero ai capi
          const amp = (Math.sin(Math.PI * t)) * (1.8 + offset);
          const jx = (r() - 0.5) * amp * 2.2;
          const jy = (r() - 0.5) * amp * 2.8;

          pts.push({ x: p.x + jx, y: p.y + jy });
        }

        // path con curve morbide (quadratic)
        let d = `M ${pts[0].x.toFixed(2)} ${pts[0].y.toFixed(2)}`;
        for (let i = 1; i < pts.length - 1; i++) {
          const cpx = pts[i].x;
          const cpy = pts[i].y;
          const nx = (pts[i].x + pts[i+1].x) / 2;
          const ny = (pts[i].y + pts[i+1].y) / 2;
          d += ` Q ${cpx.toFixed(2)} ${cpy.toFixed(2)} ${nx.toFixed(2)} ${ny.toFixed(2)}`;
        }
        d += ` L ${pts[pts.length-1].x.toFixed(2)} ${pts[pts.length-1].y.toFixed(2)}`;
        return d;
      }

      aPath.setAttribute('d', makeScribble(0));
      bPath.setAttribute('d', makeScribble(0.7));
    }

    // init
    (function init(){
      mountTshirtText();
      setupFilters();
      fitTshirtText();
      window.addEventListener('resize', () => {
        fitTshirtText();
        // ridisegna scribble con seed corrente (leggo attivi)
        const c = document.querySelector('#categoryGroup .pill.is-active')?.dataset.filter || '';
        const t = document.querySelector('#tagGroup .pill.is-active')?.dataset.filter || '';
        drawScribble(c + '|' + t);
      });
    })();
  </script>

</body>
</html>
